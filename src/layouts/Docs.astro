---
import "../styles/global.css";
import DocsTocScript from "../components/DocsTocScript.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SIDEBAR_SECTIONS } from "../utils/navigation";
import { SITE_CONTENT } from "../utils/siteContent";

const { title, enableToc = false } = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{title}</title>
  </head>
  <body>
    <a
      href="#main-content"
      class="sr-only focus:not-sr-only focus:fixed focus:left-4 focus:top-4 focus:z-[100] focus:rounded-md focus:bg-white focus:px-3 focus:py-2 focus:text-sm focus:font-semibold focus:text-slate-900 focus:shadow-lg"
    >
      Skip to content
    </a>

    <div class="flex flex-col min-h-screen">
    <div
      class="bg-indigo-600 px-4 py-2 text-center text-[11px] font-medium tracking-wide text-white sm:py-2.5 sm:text-xs"
    >
      {SITE_CONTENT.announcement}
      <a href="#intelligence" class="ml-2 underline underline-offset-2"
        >{SITE_CONTENT.announcementLinkLabel}</a
      >
    </div>
    <Header />
    <div class="flex flex-1 pt-16">
      <!-- LEFT NAV -->
      <aside
        id="sidebar"
        class="w-64 border-r border-slate-800 p-6 md:block sidebar-hidden text-black"
      >
        <button
          id="sidebar-toggle-btn"
          class="mb-4 px-2 py-1 rounded bg-slate-800 hover:bg-slate-700 focus:outline-none md:hidden"
        >
          Toggle Navigation
        </button>
        <h2 class="text-lg font-semibold">{SITE_CONTENT.sidebarHeading}</h2>

        {SIDEBAR_SECTIONS.map((section) => (
          <div class="mb-6">
            {section.heading && (
              <h3 class="h3-section-label">
                {section.heading}
              </h3>
            )}
            <ul class="space-y-1 text-sm">
              {section.links.map((link) => (
                <li><a href={link.href} class="hover:text-white">{link.label}</a></li>
              ))}
            </ul>
          </div>
        ))}
      </aside>

      <button
        type="button"
        aria-label="Close menu"
        class="fixed inset-0 z-30 hidden bg-slate-900/20 backdrop-blur-[1px] lg:hidden"
        data-mobile-backdrop></button>

      <main id="main-content" class="flex-1 p-6 md:p-10">
        <slot />
      </main>

      <!-- MAIN + RIGHT TOC -->
      <!-- <main class="flex flex-1">
        <div class="mx-auto flex-1 max-w-3xl p-6 md:p-10">
          <slot />
        </div> -->

      {
        enableToc && (
          <aside
            id="article-toc"
            class="hidden xl:block w-64 border-l border-slate-800 p-4 text-sm text-black sticky top-16 self-start"
          >
            <h2 class="h2-section-label text-xs font-semibold">
              {SITE_CONTENT.tocHeading}
            </h2>
            <nav>
              <ul id="article-toc-list" class="space-y-1 text-xs" />
            </nav>
          </aside>
        )
      }
    </div>
    </div>

    <DocsTocScript enableToc={enableToc} />
    <Footer />
  </body>
</html>
